import getWindow from "./getWindow.js";
import getDocumentElement from "./getDocumentElement.js";
import getWindowScrollBarX from "./getWindowScrollBarX.js";

export default function getViewportRect(element) {
  if (typeof element !== "object" || element === null || !("nodeType" in element)) {
    throw new TypeError("The element argument must be a DOM element.");
  }

  const win = getWindow(element);
  if (typeof win !== "object" || win === null) {
    throw new TypeError("The getWindow function must return a Window object.");
  }

  const html = getDocumentElement(element);
  if (typeof html !== "object" || html === null) {
    throw new TypeError("The getDocumentElement function must return a HTMLHtmlElement object.");
  }

  const visualViewport = win.visualViewport;
  if (typeof visualViewport === "undefined") {
    throw new Error("The visualViewport API is not supported in this browser.");
  }

  let width = html.clientWidth;
  let height = html.clientHeight;
  let x = 0;
  let y = 0;

  if (typeof visualViewport.width === "number" && visualView
